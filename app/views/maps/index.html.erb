<h2>Fun with Data Viz: Creating shapes.</h2>

<h4><%= link_to "Example 2: Stock Chart", pages_stockchart_path %></h4>


<br />
<br />
<button id="dataToggle">Data Toggle</button>
<a href="#" id="dataReset">Reset Data</a>

<div id="barchart"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var dataset1 = [10, 12, 15, 20, 22, 24, 33, 40, 42, 43, 46, 50, 80, 31];


var width = 700;
var height = 350;

var color = d3.scale.category20c();

var canvas = d3.select("#barchart")
  .append("svg")
  .attr("width", width)
  .attr("height", height)
  .attr("padding", 40);

// function drawBars() {
       
//   .transition()
//   .delay(function (d,i) { return i * 200; })
//   .duration( function(d,i){ return d * 100; })
//   .attr("width", function(d) { return xScale(d); }) 
//   .attr("height", 10)
//   .attr("fill", function(d) { return color(d) })
//   .attr("x", 50)
//   .attr("y", function(d, i) { return i * 15 })
//   .attr("stroke", function(d) { return color(d*25) });
// };


// draw chart

function render(sub) {

// set up scale
var xScale = d3.scale.linear()
  .domain([0, d3.max(sub, function(d){ return d; })])
  .range([0, width]);        

// add horizontal bars
var bars = canvas.selectAll("rect")
    .data(sub) 
    .enter() 
    .append("rect")
    .attr("class", "bars")
    .transition()
    .delay(function (d,i) {
      return i * 200;
    })
    .duration( function(d,i){ return d * 100; })
    .attr("width", function(d) { return xScale(d); }) 
    .attr("height", 10)
    .attr("fill", function(d) { return color(d) })
    .attr("x", 50)
    .attr("y", function(d, i) { return i * 15 })
    .attr("stroke", function(d) { return color(d*25) });

// set up axis
var xAxis = d3.svg.axis()
  .scale(xScale)
  .orient("bottom")
  .ticks(6);

// add x-axis
canvas.append("g")
  .attr("class", "axis")
  .attr("transform", "translate(50,220)")
  .style("opacity", 0.2)
  .call(xAxis);



d3.select("#dataToggle")
  .on("click", function() {
  
    dataset2 = [1, 3, 5, 6, 7, 14, 10, 20, 25, 35, 40, 46, 55, 57, 58];
    
  canvas.selectAll('rect')
    .data(dataset2)
    .transition()
    .delay(function (d,i) {
          return i * 200;
    })
    .duration( function(d,i){ return d * 100; })
    .attr("width", function(d) { return xScale(d); }) 
    .attr("height", 10)
    .attr("fill", function(d) { return color(d) })
    .attr("x", 50)
    .attr("y", function(d, i) { return i * 15 })
    .attr("stroke", function(d) { return color(d*25) })
  });

};

  render(dataset1);
  
$('#dataToggle').hover(function() {
  $(this).css({color: "blue" })
});

$('#dataReset').click( render(dataset1) );

// $('#dataToggle').hover(function() {$('this').css({background-color: "aliceblue" })});

</script>

<style>

body {
    margin-left: 20px;

}

#barchart {
  background-color: aliceblue;
  width: 70%;
  height: 350px;
  border: 1px blue solid;
} 

svg {
  margin-top: 50px;
}
</style>

